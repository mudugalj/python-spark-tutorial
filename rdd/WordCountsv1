stopwords = sc.textFile("/Users/prajaya/python-spark-tutorial/in/stopwords.text")
stopwords = stopwords.collect()
words = sc.textFile("/Users/prajaya/python-spark-tutorial/in/word_count.text")
wordsFlattened = words.flatMap(lambda x : x.split(" "))
wordsCleaned = wordsFlattened.filter(lambda x : x not in stopwords)
wordsLower = wordsCleaned.map(lambda l : l.lower())
wordsMapper = wordsLower.map(lambda m : (m,1))
wordsCount = wordsMapper.reduceByKey(lambda x,y : x+y)
wordsSorted = wordsCount.takeOrdered(5, lambda a : -a[1])
for i in wordsSorted : print(i[0] + " repeats " + str(i[1]) + " times")